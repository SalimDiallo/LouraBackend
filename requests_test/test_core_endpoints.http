### ======================================
### LOURA BACKEND - CORE APP ENDPOINTS
### ======================================
### Base URL: http://localhost:8000/api/core
###
### Instructions:
### 1. Ex�cuter d'abord Register ou Login pour obtenir les tokens
### 2. Les tokens sont automatiquement stock�s dans les cookies HTTP-only
### 3. Utiliser les tokens dans les headers pour les endpoints prot�g�s
###
### Variables � personnaliser selon vos besoins
### ======================================

@baseUrl = http://localhost:8000/api/core
@email = admin@gmail.com
@password = Admin123!
@accessToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzY0MTkyMDAyLCJpYXQiOjE3NjQxOTExMDIsImp0aSI6IjU5MmI1ODhlZDAzZDQ5MTA4ODg1OTk0NDMzMjlhZmIzIiwidXNlcl9pZCI6IjdkNDM5ODM4LWFmMTUtNGY5NC1iMDBjLTYzNWU1NjAyMDFkNSJ9.BoRh_uXAdrlI-o3mQEInkAer7nUILVEumvkQW8ntIkA
@refreshToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoicmVmcmVzaCIsImV4cCI6MTc2NDc5NTkwMiwiaWF0IjoxNzY0MTkxMTAyLCJqdGkiOiIyNGQzNmMwNTA5N2M0YWRmOTAxM2Y0NjdjZWE3ZjI3MSIsInVzZXJfaWQiOiI3ZDQzOTgzOC1hZjE1LTRmOTQtYjAwYy02MzVlNTYwMjAxZDUifQ.aXydOpmcqNT56btRfKSkKOYhPa5iXkGx6iV9KZ56yD0
@orgId = 6b9632c1-c1fb-4a68-b5bf-c156dd758084


### ======================================
### 1. AUTHENTICATION ENDPOINTS
### ======================================

### 1.1 Register - Inscription d'un nouvel administrateur
POST {{baseUrl}}/auth/register/
Content-Type: application/json

{
  "email": "admin@loura.com",
  "password": "SecurePass123!",
  "password_confirm": "SecurePass123!",
  "first_name": "Admin",
  "last_name": "Loura",
  "phone": "+224620000000"
}

### Exemple avec donn�es minimales (seuls email et password requis)
POST {{baseUrl}}/auth/register/
Content-Type: application/json

{
  "email": "{{email}}",
  "password": "{{password}}",
  "password_confirm": "{{password}}"
}


### 1.2 Login - Connexion
POST {{baseUrl}}/auth/login/
Content-Type: application/json

{
  "email": "{{email}}",
  "password": "{{password}}"
}


### 1.3 Get Current User - Obtenir l'utilisateur connect�
GET {{baseUrl}}/auth/me/
Authorization: Bearer {{accessToken}}


### 1.4 Refresh Token - Rafra�chir le token d'acc�s
POST {{baseUrl}}/auth/refresh/
Content-Type: application/json

{
  "refresh": "{{refreshToken}}"
}


### 1.5 Logout - D�connexion
POST {{baseUrl}}/auth/logout/
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "refresh": "{{refreshToken}}"
}


### ======================================
### 2. ORGANIZATIONS ENDPOINTS
### ======================================

### 2.1 List Organizations - Lister toutes les organisations de l'admin connect�
GET {{baseUrl}}/organizations/
Authorization: Bearer {{accessToken}}


### 2.2 Create Organization - Cr�er une nouvelle organisation
POST {{baseUrl}}/organizations/
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "name": "Ma Premi�re Organisation",
  "subdomain": "premiere-org",
  "category": 1,
  "settings": {
    "currency": "GNF",
    "country": "GN",
    "timezone": "Africa/Conakry",
    "language": "fr"
  }
}

### Exemple avec plus de param�tres
POST {{baseUrl}}/organizations/
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "name": "Tech Solutions SARL",
  "subdomain": "techsolutions",
  "category": 2,
  "is_active": true,
  "settings": {
    "currency": "EUR",
    "country": "FR",
    "timezone": "Europe/Paris",
    "language": "fr",
    "theme": "dark",
    "logo_url": "https://example.com/logo.png"
  }
}

### Exemple minimal (seuls name, subdomain et category sont requis)
POST {{baseUrl}}/organizations/
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "name": "Organisation Test",
  "subdomain": "org-test",
  "category": 1
}


### 2.3 Get Organization Details - Obtenir les d�tails d'une organisation
GET {{baseUrl}}/organizations/{{orgId}}/
Authorization: Bearer {{accessToken}}


### 2.4 Update Organization (PUT) - Mise � jour compl�te
PUT {{baseUrl}}/organizations/{{orgId}}/
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "name": "Organisation Mise a Jour",
  "subdomain": "org-updated",
  "category": 1,
  "is_active": true,
  "settings": {
    "currency": "USD",
    "country": "US",
    "timezone": "America/New_York",
    "language": "en"
  }
}


### 2.5 Update Organization (PATCH) - Mise � jour partielle
PATCH {{baseUrl}}/organizations/{{orgId}}/
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "name": "Nouveau Nom Organisation"
}

### Exemple: Mise � jour des settings uniquement
PATCH {{baseUrl}}/organizations/{{orgId}}/
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "settings": {
    "theme": "light",
    "language": "en"
  }
}


### 2.6 Activate Organization - Activer une organisation
POST {{baseUrl}}/organizations/{{orgId}}/activate/
Authorization: Bearer {{accessToken}}


### 2.7 Deactivate Organization - D�sactiver une organisation
POST {{baseUrl}}/organizations/{{orgId}}/deactivate/
Authorization: Bearer {{accessToken}}


### 2.8 Delete Organization - Supprimer une organisation (soft delete)
DELETE {{baseUrl}}/organizations/{{orgId}}/
Authorization: Bearer {{accessToken}}


### ======================================
### 3. CATEGORIES ENDPOINTS (Read-Only)
### ======================================

### 3.1 List Categories - Lister toutes les cat�gories
GET {{baseUrl}}/categories/
Authorization: Bearer {{accessToken}}


### 3.2 Get Category Details - Obtenir les d�tails d'une cat�gorie
GET {{baseUrl}}/categories/1/
Authorization: Bearer {{accessToken}}


### ======================================
### 4. SC�NARIOS DE TEST COMPLETS
### ======================================

### Sc�nario 1: Inscription et cr�ation d'organisation
# 1. Register
POST {{baseUrl}}/auth/register/
Content-Type: application/json

{
  "email": "nouveau@test.com",
  "password": "Pass123!",
  "password2": "Pass123!",
  "first_name": "Nouveau",
  "last_name": "Utilisateur"
}

# 2. Copier le access token de la r�ponse
# 3. Cr�er une organisation
POST {{baseUrl}}/organizations/
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "name": "Nouvelle Entreprise",
  "subdomain": "nouvelle-entreprise",
  "category": 1
}


### Sc�nario 2: Gestion du cycle de vie d'une organisation
# 1. Cr�er organisation (voir ci-dessus)
# 2. Consulter les d�tails
# 3. D�sactiver
# 4. R�activer
# 5. Supprimer


### ======================================
### 5. TESTS D'ERREURS
### ======================================

### Test: Inscription avec mot de passe non conforme
POST {{baseUrl}}/auth/register/
Content-Type: application/json

{
  "email": "test@test.com",
  "password": "123",
  "password2": "123"
}


### Test: Connexion avec credentials invalides
POST {{baseUrl}}/auth/login/
Content-Type: application/json

{
  "email": "wrong@email.com",
  "password": "wrongpassword"
}


### Test: Acc�s � un endpoint prot�g� sans token
GET {{baseUrl}}/organizations/


### Test: Cr�ation organisation avec subdomain d�j� existant
POST {{baseUrl}}/organizations/
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "name": "Test Duplicate",
  "subdomain": "premiere-org",
  "category": 1
}


### Test: Acc�s � une organisation qui n'appartient pas � l'admin
GET {{baseUrl}}/organizations/99999/
Authorization: Bearer {{accessToken}}


### ======================================
### 6. NOTES IMPORTANTES
### ======================================

### Cookies HTTP-Only:
### Les endpoints d'authentification d�finissent automatiquement
### les tokens dans des cookies HTTP-only pour plus de s�curit�.
### Les tokens sont �galement retourn�s dans le corps de la r�ponse
### pour plus de flexibilit�.

### Tokens JWT:
### - Access Token: 15 minutes de validit�
### - Refresh Token: 7 jours de validit�
### - Les refresh tokens sont automatiquement rot�s et blacklist�s

### Multi-Tenant:
### - Chaque AdminUser ne voit que ses propres organisations
### - Le subdomain doit �tre unique dans tout le syst�me
### - Les organisations ont des settings personnalisables

### Soft Delete:
### - La suppression d'une organisation est "soft"
### - L'organisation reste en base avec deleted_at != null
### - Pour restauration ult�rieure si n�cessaire

### Champs Settings disponibles:
### - currency: Code devise (ex: GNF, EUR, USD, MAD)
### - country: Code pays (ex: GN, FR, MA)
### - timezone: Fuseau horaire (ex: Africa/Conakry)
### - language: Langue (ex: fr, en)
### - theme: Th�me UI (optionnel)
### - logo_url: URL du logo (optionnel)
